# VPN Admin Guide (`devops-vpn-project`)

## üìå Quick Access
| –î–µ–π—Å—Ç–≤–∏–µ                  | –°–∫—Ä–∏–ø—Ç                          | –ö–æ–º–∞–Ω–¥–∞ –ø—Ä–∏–º–µ—Ä–∞                               |
|---------------------------|---------------------------------|-----------------------------------------------|
| –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è     | `scripts/gen-client-cert.sh`    | `sudo ./scripts/gen-client-cert.sh ivanov`    |
| –û—Ç–æ–∑–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç       | `scripts/revoke-client-cert.sh` | `sudo ./scripts/revoke-client-cert.sh petrov` |
| –°–±—Ä–æ—Å–∏—Ç—å firewall         | `scripts/reset-firewall.sh`     | `sudo ./scripts/reset-firewall.sh`            |

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤
devops-vpn-project/
‚îî‚îÄ‚îÄ scripts/
‚îú‚îÄ‚îÄ gen-client-cert.sh # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
‚îú‚îÄ‚îÄ revoke-client-cert.sh # –û—Ç–∑—ã–≤ –¥–æ—Å—Ç—É–ø–∞
‚îî‚îÄ‚îÄ ... # –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
---

### ** 2. –†–∞–∑–¥–µ–ª—ã —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ —Å–∫—Ä–∏–ø—Ç–∞–º **

#### **üîê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**  
### 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
–î–ª—è –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ [—ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç](https://github.com/Zarinec/devops-vpn-project/blob/main/scripts/gen-client-cert.sh).  
`scripts/gen-client-cert.sh <username>`  

**–ü—Ä–∏–º–µ—Ä:**  
```bash
sudo ./scripts/gen-client-cert.sh ivanov
–ì–¥–µ –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª—ã:

–ö–æ–Ω—Ñ–∏–≥: /etc/openvpn/client-configs/ivanov.ovpn
–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç: /etc/easy-rsa/pki/issued/ivanov.crt
–ú–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ:

```bash
# –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ —Ñ–∞–π–ª `users.list` —Å –∏–º–µ–Ω–∞–º–∏
sudo ./scripts/bulk-gen-certs.sh

#### **‚ùå –û—Ç–∑—ã–≤ –¥–æ—Å—Ç—É–ø–∞**  
```markdown
### 2. –û—Ç–∑—ã–≤ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞  
–°–∫—Ä–∏–ø—Ç: `scripts/revoke-client-cert.sh`  

**–ö–æ–º–∞–Ω–¥–∞:**  
```bash
sudo ./scripts/revoke-client-cert.sh petrov && sudo systemctl restart openvpn
–ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
openssl crl -in /etc/easy-rsa/pki/crl.pem -text | grep "petrov"

---

### **3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏**
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –¥–æ–±–∞–≤–ª—è—é **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã** –∏–∑ –≤–∞—à–µ–≥–æ –∫–æ–¥–∞:

#### **–ü—Ä–∏–º–µ—Ä –¥–ª—è `revoke-client-cert.sh`**
```markdown
## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è  
–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:  
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ (`/etc/easy-rsa/pki/issued/$1.crt`)  
2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç CRL (`easyrsa gen-crl`)  
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç OpenVPN (`systemctl restart openvpn`)  

**–õ–æ–≥–∏:**  
```bash
tail -f /var/log/vpn-install.log  # –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

---

### **4. –í–∏–∑—É–∞–ª—å–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏**
–î–æ–±–∞–≤–ª—è—é **–∏–∫–æ–Ω–∫–∏ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è** –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞:  
```markdown
> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**  
> –ü–æ—Å–ª–µ –æ—Ç–∑—ã–≤–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:  
> - –£–≤–µ–¥–æ–º–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
> - –û–±–Ω–æ–≤–∏—Ç–µ –±—ç–∫–∞–ø—ã (`/etc/easy-rsa/pki/`)  

> üí° **–°–æ–≤–µ—Ç**  
> –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π:  
> ```bash  
> cat /var/log/openvpn-status.log | grep "10.8.0."  
> ```
5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```markdown
## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ  
1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:  
   ```bash  
   sudo ./scripts/gen-client-cert.sh test_user  
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥:
   ```bash
   cat /etc/openvpn/client-configs/test_user.ovpn | grep "remote"  
3. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å —á–µ—Ä–µ–∑ OpenVPN-–∫–ª–∏–µ–Ω—Ç.
```
